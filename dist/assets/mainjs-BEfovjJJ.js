import"./calcef-Tug2CzmB.js";import"./manoobra-CQw6rAlR.js";import"./tabla-D-dO7D9q.js";import"./tablacostos-C8qWL17H.js";import"./tablalotes-PkjVkhj2.js";import"./tablaobra-I24x0HfO.js";import"./lit-element-vPvpt891.js";import"./obtenerDatos-KJbPXA-C.js";const x=(o,e)=>o/e,C=(o,e)=>o/e*100+"%",O=(o,e)=>o-e,U=(o,e)=>o/e;document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("calcular-productividad"),e=document.querySelector("calc-eficiencia").shadowRoot,t=e.getElementById("myModal"),a=e.getElementById("closeModalBtn"),n=e.getElementById("calcForm"),s=e.getElementById("form-container"),r=e.getElementById("resultado-container"),l=e.getElementById("resultado");o.addEventListener("click",()=>{t.style.display="flex"}),a.addEventListener("click",()=>{t.style.display="none",n.reset(),s.style.display="block",r.style.display="none"}),n.addEventListener("submit",m=>{m.preventDefault();const i=e.getElementById("total").value;e.getElementById("horas").value;const u=e.getElementById("costos").value,c=e.getElementById("defectos").value,y=O(i,c),d=U(y,u),p=C(c,i);console.log(p),s.style.display="none",r.style.display="flex",l.textContent=d.toFixed(2)})});const N="https://664a2109a300e8795d41126f.mockapi.io/api/1/costosindirectos",H=(o,e)=>o/e;async function $(){try{const o=await fetch(N,{method:"GET"});if(!o.ok)throw new Error("Error al obtener los datos de la API");const e=await o.json();let t=0;for(const a of e){const n=parseFloat(a.valor);t+=isNaN(n)?0:n}return console.log("La suma de todos los valores es:",t),t}catch(o){throw console.error("Error:",o),o}}const q=(o,e)=>o*e,G=(o,e,t)=>o*e*t,V=(o,e,t)=>o+e+t,J=(o,e)=>o*e,z=o=>o.toLocaleString("es-CO",{style:"currency",currency:"COP"}).replace(/COP\s/,""),I=(o,e,t)=>{fetch(o,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(a=>{if(a.ok)return a.json()}).catch(a=>{console.log("No se pudo enviar los datos")}),t.reset()};let g,b,h;const K="https://665630689f970b3b36c49525.mockapi.io/manoDeObra";document.addEventListener("DOMContentLoaded",()=>{const o=document.querySelector("calc-eficiencia").shadowRoot;o.getElementById("calcForm").addEventListener("submit",()=>{g=o.getElementById("total").value,b=o.getElementById("costos").value,h=o.getElementById("defectos").value});const t=document.getElementById("calcularManoDeObra"),a=document.querySelector("calc-obra").shadowRoot,n=a.getElementById("myModal"),s=a.getElementById("closeModalBtn"),r=a.getElementById("calcForm"),l=a.getElementById("form-container"),m=a.getElementById("resultado-container"),i=a.getElementById("resultado");t.addEventListener("click",()=>{n.style.display="flex"}),s.addEventListener("click",()=>{n.style.display="none",r.reset(),l.style.display="block",m.style.display="none"}),r.addEventListener("submit",u=>{u.preventDefault();const c=a.getElementById("totalEmpleados").value,y=a.getElementById("salarioBase").value,d=a.getElementById("horasTrabajadas").value,p=a.getElementById("beneficios").value,E=O(g,h),A=U(E,b),F=x(b,g),D=H(y,d),P=G(D,d,c),L=q(p,c);$().then(f=>{console.log(f);const R=C(h,g),k=V(P,L,f),S=J(d,c);l.style.display="none",m.style.display="flex",i.textContent=z(k),fetch(K,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({empleados:c,productividadEfectiva:E,costosOperativosUnd:F,tasaDeDefectos:R,eficienciaOperativa:A,salarioPorHora:D,horasTrabajadas:S,costosIndirectosTotales:f,beneficiosTotales:L,salarioTotal:P,manoDeObraTotal:k})}).then(v=>{if(v.ok)return v.json()}).catch(v=>{console.log("No se pudo enviar los datos")})}).catch(f=>{console.error("Error al calcular costos indirectos totales:",f)})})});const Q="https://665630689f970b3b36c49525.mockapi.io/materiaPrima",T=document.getElementById("mpForm");T.addEventListener("submit",o=>{o.preventDefault();const e=document.getElementById("cantidad").value;let t={idMateriaPrima:document.getElementById("idMp").value,nombre:document.getElementById("nombre").value,fechaDeAdquisicion:document.getElementById("fechaAdqui").value,fechaDeVencimiento:document.getElementById("fechaVenci").value,costoUnidad:document.getElementById("costoUnidad").value,proveedor:document.getElementById("proveedor").value,descripcion:document.getElementById("descripcion").value,unidadMedida:document.getElementById("unidadMedida").value,cantidad:parseInt(e),categoria:document.getElementById("categoria").value,ubicacion:document.getElementById("ubicacion").value};I(Q,t,T)});const W=document.getElementById("inventario"),X=document.getElementById("inventoryDiv"),Y=document.getElementById("prodDiv"),Z=document.getElementById("prodDiv"),_=document.getElementById("mpForm");W.addEventListener("click",()=>{X.style.display="none",Y.style.display="none",Z.style.display="none",_.style.display="flex"});const oo=document.getElementById("produccion"),eo=document.getElementById("inventoryDiv"),to=document.getElementById("prodDiv"),ao=document.getElementById("prodDiv"),no=document.getElementById("productForm");oo.addEventListener("click",()=>{eo.style.display="none",to.style.display="none",ao.style.display="none",no.style.display="flex"});const so=document.getElementById("Costos-indirectos"),ro=document.getElementById("inventoryDiv"),co=document.getElementById("prodDiv"),lo=document.getElementById("prodDiv"),io=document.getElementById("costoForm");so.addEventListener("click",()=>{ro.style.display="none",co.style.display="none",lo.style.display="none",io.style.display="flex"});const B=[{nombre:"Camisa manga Larga",hilos:50,botones:6,telas:3,id:"1",horas:4,trabajadores:4},{nombre:"Camisa manga Corta",hilos:45,botones:6,telas:2,id:"2",horas:3,trabajadores:4},{nombre:"Vestido Largo",hilos:20,botones:1,telas:5,sierres:1,lentejuelas:100,cauchos:2,encajes:12,"costo-unidad":0,id:"6",horas:1,trabajadores:4},{nombre:"Vestido Corto",hilos:15,botones:1,telas:4,sierres:1,lentejuelas:50,cauchos:2,encajes:8,"costo-unidad":0,id:"4",horas:5,trabajadores:4},{nombre:"Pantalon de Vestir",hilos:20,botones:3,telas:3,sierres:1,cauchos:1,"costo-unidad":0,id:"5",horas:4,trabajadores:4},{nombre:"Pantalon de Jean",hilos:20,botones:1,telas:3,sierres:1,"costo-unidad":0,id:"6",horas:3,trabajadores:4},{nombre:"Short",hilos:12,botones:2,telas:2,sierres:1,id:"7",horas:2,trabajadores:4}],w="https://665630689f970b3b36c49525.mockapi.io/materiaPrima";function mo(o,e){const t=B.find(n=>n.nombre===o);if(!t)throw new Error(`Producto "${o}" no encontrado.`);const a={};for(const n in t)n!=="nombre"&&n!=="id"&&n!=="costo-unidad"&&n!=="horas"&&n!=="trabajadores"&&(a[n]=t[n]*e);return console.log(a),a}async function uo(o){try{const e=await fetch(w);if(!e.ok)throw new Error("Error al obtener los datos de la API de materia prima");let t=await e.json();for(const a in o){let n=o[a],s=t.find(r=>r.categoria===a);for(;n>0&&s;)s.cantidad>=n?(s.cantidad-=n,n=0):(n-=s.cantidad,s.cantidad=0,s=t.find(r=>r.categoria===a&&r.cantidad>0));if(n>0){alert(`No hay suficiente stock de ${a} para la producción.`);break}s&&await fetch(`${w}/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}return console.log("Datos de materia prima actualizados correctamente."),!0}catch(e){return console.error("Error al actualizar la API de materia prima:",e.message),!1}}const yo=(o,e,t)=>{const a=B.find(s=>s.nombre===o);if(!a)return console.error(`No se encontró la prenda para el producto ${o}`),0;let n=0;return Object.keys(a).forEach(s=>{s!=="nombre"&&s!=="id"&&s!=="horas"&&s!=="trabajadores"&&s!=="costo-unidad"&&(t[s]?n+=a[s]*e*t[s]:console.error(`No se encontró costo por unidad para ${s}`))}),n},po=(o,e)=>o*e,fo=(o,e)=>o/e,Eo=(o,e)=>o*e,go="https://66586d8e5c36170526486c75.mockapi.io/lotes",vo="https://665630689f970b3b36c49525.mockapi.io/manoDeObra",bo="https://665630689f970b3b36c49525.mockapi.io/materiaPrima",M=document.getElementById("productForm");M.addEventListener("submit",async o=>{o.preventDefault();const e=document.getElementById("producto").value,t=parseInt(document.getElementById("cantidadproductos").value),a=document.getElementById("productosmes").value,n=await $();try{const s=fo(n,a),r=s+"%";let l=Io(e,t);console.log("Horas Trabajadas:",l);const m=Eo(t,s),i=await fetch(vo);if(!i.ok)throw new Error("Error al obtener el salario de la API");const u=await i.json(),c=u[u.length-1].salarioPorHora,y=await ho();console.log(y);const d=yo(e,t,y),p=mo(e,t);console.log("Gastos Materiales Lote:",d);const E=po(l,c);await uo(p),I(go,{producto:e,cantidad:t,baseasignacion:a,horastrabajadas:l,costoMOlote:E,costoMPlote:d,tasaAsignacionTabla:r,costosidirectoslote:m},M)}catch(s){console.error("Error:",s)}});async function ho(){try{const o=await fetch(bo);if(!o.ok)throw new Error("Error al obtener los costos de la API");const e=await o.json();console.log("Datos de la API de costos:",e);let t={};return e.forEach(a=>{const n=a.categoria.toLowerCase(),s=typeof a.costoUnidad=="string"?parseFloat(a.costoUnidad):a.costoUnidad;t[n]?t[n]+=s:t[n]=s}),console.log("Costos por categoría:",t),t}catch(o){throw console.error("Error al obtener los costos de la API:",o),o}}function Io(o,e){const t=B.find(a=>a.nombre===o);return console.log("Prenda:",t),t&&t.horas?t.horas*e:0}document.getElementById("cantidadproductos");const Bo="https://664a2109a300e8795d41126f.mockapi.io/api/1/costosindirectos",j=document.getElementById("costoForm");j.addEventListener("submit",o=>{o.preventDefault();let e={tipoCosto:document.getElementById("nombre-costo").value,valor:document.getElementById("valor-costo").value,descripcion:document.getElementById("descripcion-costo").value};I(Bo,e,j)});
